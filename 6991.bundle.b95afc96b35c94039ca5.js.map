{"version":3,"file":"6991.bundle.b95afc96b35c94039ca5.js","mappings":"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","sources":["webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ChangeTypes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Events.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/SegmentationRepresentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/StrategyCallbacks.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ToolBindings.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ToolModes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Touch.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/AnnotationStyleStates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/WorkerTypes.js","webpack:///../../../extensions/usAnnotation/src/PleuraBlinePercentage.ts","webpack:///../../../extensions/usAnnotation/src/id.js","webpack:///../../../extensions/usAnnotation/src/panels/USAnnotationPanel.tsx","webpack:///../../../extensions/usAnnotation/src/getPanelModule.tsx","webpack:///../../../extensions/usAnnotation/src/getCommandsModule.ts","webpack:///../../../extensions/usAnnotation/src/index.ts","webpack:///../../../extensions/usAnnotation/src/getInstanceByImageId.ts"],"sourcesContent":["var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"Interaction\"] = \"Interaction\";\n    ChangeTypes[\"HandlesUpdated\"] = \"HandlesUpdated\";\n    ChangeTypes[\"StatsUpdated\"] = \"StatsUpdated\";\n    ChangeTypes[\"InitialSetup\"] = \"InitialSetup\";\n    ChangeTypes[\"Completed\"] = \"Completed\";\n    ChangeTypes[\"InterpolationUpdated\"] = \"InterpolationUpdated\";\n    ChangeTypes[\"History\"] = \"History\";\n    ChangeTypes[\"MetadataReferenceModified\"] = \"MetadataReferenceModified\";\n    ChangeTypes[\"LabelChange\"] = \"LabelChange\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","var Events;\n(function (Events) {\n    Events[\"TOOL_ACTIVATED\"] = \"CORNERSTONE_TOOLS_TOOL_ACTIVATED\";\n    Events[\"TOOLGROUP_VIEWPORT_ADDED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED\";\n    Events[\"TOOLGROUP_VIEWPORT_REMOVED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED\";\n    Events[\"TOOL_MODE_CHANGED\"] = \"CORNERSTONE_TOOLS_TOOL_MODE_CHANGED\";\n    Events[\"CROSSHAIR_TOOL_CENTER_CHANGED\"] = \"CORNERSTONE_TOOLS_CROSSHAIR_TOOL_CENTER_CHANGED\";\n    Events[\"VOLUMECROPPINGCONTROL_TOOL_CHANGED\"] = \"CORNERSTONE_TOOLS_VOLUMECROPPINGCONTROL_TOOL_CHANGED\";\n    Events[\"VOLUMECROPPING_TOOL_CHANGED\"] = \"CORNERSTONE_TOOLS_VOLUMECROPPING_TOOL_CHANGED\";\n    Events[\"ANNOTATION_ADDED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_ADDED\";\n    Events[\"ANNOTATION_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_COMPLETED\";\n    Events[\"ANNOTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_MODIFIED\";\n    Events[\"ANNOTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_REMOVED\";\n    Events[\"ANNOTATION_SELECTION_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE\";\n    Events[\"ANNOTATION_LOCK_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE\";\n    Events[\"ANNOTATION_VISIBILITY_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE\";\n    Events[\"ANNOTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_RENDERED\";\n    Events[\"ANNOTATION_CUT_MERGE_PROCESS_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_CUT_MERGE_PROCESS_COMPLETED\";\n    Events[\"ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\";\n    Events[\"INTERPOLATED_ANNOTATIONS_REMOVED\"] = \"CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED\";\n    Events[\"SEGMENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_RENDERED\";\n    Events[\"SEGMENTATION_REPRESENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED\";\n    Events[\"SEGMENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_ADDED\";\n    Events[\"SEGMENTATION_REPRESENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REMOVED\";\n    Events[\"SEGMENTATION_REPRESENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED\";\n    Events[\"SEGMENTATION_DATA_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED\";\n    Events[\"HISTORY_UNDO\"] = \"CORNERSTONE_TOOLS_HISTORY_UNDO\";\n    Events[\"HISTORY_REDO\"] = \"CORNERSTONE_TOOLS_HISTORY_REDO\";\n    Events[\"KEY_DOWN\"] = \"CORNERSTONE_TOOLS_KEY_DOWN\";\n    Events[\"KEY_UP\"] = \"CORNERSTONE_TOOLS_KEY_UP\";\n    Events[\"MOUSE_DOWN\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN\";\n    Events[\"MOUSE_UP\"] = \"CORNERSTONE_TOOLS_MOUSE_UP\";\n    Events[\"MOUSE_DOWN_ACTIVATE\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE\";\n    Events[\"MOUSE_DRAG\"] = \"CORNERSTONE_TOOLS_MOUSE_DRAG\";\n    Events[\"MOUSE_MOVE\"] = \"CORNERSTONE_TOOLS_MOUSE_MOVE\";\n    Events[\"MOUSE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_CLICK\";\n    Events[\"MOUSE_DOUBLE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK\";\n    Events[\"MOUSE_WHEEL\"] = \"CORNERSTONE_TOOLS_MOUSE_WHEEL\";\n    Events[\"TOUCH_START\"] = \"CORNERSTONE_TOOLS_TOUCH_START\";\n    Events[\"TOUCH_START_ACTIVATE\"] = \"CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE\";\n    Events[\"TOUCH_PRESS\"] = \"CORNERSTONE_TOOLS_TOUCH_PRESS\";\n    Events[\"TOUCH_DRAG\"] = \"CORNERSTONE_TOOLS_TOUCH_DRAG\";\n    Events[\"TOUCH_END\"] = \"CORNERSTONE_TOOLS_TOUCH_END\";\n    Events[\"TOUCH_TAP\"] = \"CORNERSTONE_TOOLS_TAP\";\n    Events[\"TOUCH_SWIPE\"] = \"CORNERSTONE_TOOLS_SWIPE\";\n})(Events || (Events = {}));\nexport default Events;\n","var SegmentationRepresentations;\n(function (SegmentationRepresentations) {\n    SegmentationRepresentations[\"Labelmap\"] = \"Labelmap\";\n    SegmentationRepresentations[\"Contour\"] = \"Contour\";\n    SegmentationRepresentations[\"Surface\"] = \"Surface\";\n})(SegmentationRepresentations || (SegmentationRepresentations = {}));\nexport default SegmentationRepresentations;\n","var StrategyCallbacks;\n(function (StrategyCallbacks) {\n    StrategyCallbacks[\"OnInteractionStart\"] = \"onInteractionStart\";\n    StrategyCallbacks[\"OnInteractionEnd\"] = \"onInteractionEnd\";\n    StrategyCallbacks[\"Preview\"] = \"preview\";\n    StrategyCallbacks[\"RejectPreview\"] = \"rejectPreview\";\n    StrategyCallbacks[\"AcceptPreview\"] = \"acceptPreview\";\n    StrategyCallbacks[\"Fill\"] = \"fill\";\n    StrategyCallbacks[\"Interpolate\"] = \"interpolate\";\n    StrategyCallbacks[\"StrategyFunction\"] = \"strategyFunction\";\n    StrategyCallbacks[\"CreateIsInThreshold\"] = \"createIsInThreshold\";\n    StrategyCallbacks[\"Initialize\"] = \"initialize\";\n    StrategyCallbacks[\"INTERNAL_setValue\"] = \"setValue\";\n    StrategyCallbacks[\"AddPreview\"] = \"addPreview\";\n    StrategyCallbacks[\"ComputeInnerCircleRadius\"] = \"computeInnerCircleRadius\";\n    StrategyCallbacks[\"GetStatistics\"] = \"getStatistics\";\n    StrategyCallbacks[\"EnsureImageVolumeFor3DManipulation\"] = \"ensureImageVolumeFor3DManipulation\";\n    StrategyCallbacks[\"EnsureSegmentationVolumeFor3DManipulation\"] = \"ensureSegmentationVolumeFor3DManipulation\";\n})(StrategyCallbacks || (StrategyCallbacks = {}));\nexport default StrategyCallbacks;\n","var MouseBindings;\n(function (MouseBindings) {\n    MouseBindings[MouseBindings[\"Primary\"] = 1] = \"Primary\";\n    MouseBindings[MouseBindings[\"Secondary\"] = 2] = \"Secondary\";\n    MouseBindings[MouseBindings[\"Primary_And_Secondary\"] = 3] = \"Primary_And_Secondary\";\n    MouseBindings[MouseBindings[\"Auxiliary\"] = 4] = \"Auxiliary\";\n    MouseBindings[MouseBindings[\"Primary_And_Auxiliary\"] = 5] = \"Primary_And_Auxiliary\";\n    MouseBindings[MouseBindings[\"Secondary_And_Auxiliary\"] = 6] = \"Secondary_And_Auxiliary\";\n    MouseBindings[MouseBindings[\"Primary_And_Secondary_And_Auxiliary\"] = 7] = \"Primary_And_Secondary_And_Auxiliary\";\n    MouseBindings[MouseBindings[\"Fourth_Button\"] = 8] = \"Fourth_Button\";\n    MouseBindings[MouseBindings[\"Fifth_Button\"] = 16] = \"Fifth_Button\";\n    MouseBindings[MouseBindings[\"Wheel\"] = 524288] = \"Wheel\";\n    MouseBindings[MouseBindings[\"Wheel_Primary\"] = 524289] = \"Wheel_Primary\";\n})(MouseBindings || (MouseBindings = {}));\nvar KeyboardBindings;\n(function (KeyboardBindings) {\n    KeyboardBindings[KeyboardBindings[\"Shift\"] = 16] = \"Shift\";\n    KeyboardBindings[KeyboardBindings[\"Ctrl\"] = 17] = \"Ctrl\";\n    KeyboardBindings[KeyboardBindings[\"Alt\"] = 18] = \"Alt\";\n    KeyboardBindings[KeyboardBindings[\"Meta\"] = 91] = \"Meta\";\n    KeyboardBindings[KeyboardBindings[\"ShiftCtrl\"] = 1617] = \"ShiftCtrl\";\n    KeyboardBindings[KeyboardBindings[\"ShiftAlt\"] = 1618] = \"ShiftAlt\";\n    KeyboardBindings[KeyboardBindings[\"ShiftMeta\"] = 1691] = \"ShiftMeta\";\n    KeyboardBindings[KeyboardBindings[\"CtrlAlt\"] = 1718] = \"CtrlAlt\";\n    KeyboardBindings[KeyboardBindings[\"CtrlMeta\"] = 1791] = \"CtrlMeta\";\n    KeyboardBindings[KeyboardBindings[\"AltMeta\"] = 1891] = \"AltMeta\";\n})(KeyboardBindings || (KeyboardBindings = {}));\nexport { MouseBindings, KeyboardBindings };\n","var ToolModes;\n(function (ToolModes) {\n    ToolModes[\"Active\"] = \"Active\";\n    ToolModes[\"Passive\"] = \"Passive\";\n    ToolModes[\"Enabled\"] = \"Enabled\";\n    ToolModes[\"Disabled\"] = \"Disabled\";\n})(ToolModes || (ToolModes = {}));\nexport default ToolModes;\n","var Swipe;\n(function (Swipe) {\n    Swipe[\"UP\"] = \"UP\";\n    Swipe[\"DOWN\"] = \"DOWN\";\n    Swipe[\"LEFT\"] = \"LEFT\";\n    Swipe[\"RIGHT\"] = \"RIGHT\";\n})(Swipe || (Swipe = {}));\nexport { Swipe };\n","var AnnotationStyleStates;\n(function (AnnotationStyleStates) {\n    AnnotationStyleStates[\"Default\"] = \"\";\n    AnnotationStyleStates[\"Highlighted\"] = \"Highlighted\";\n    AnnotationStyleStates[\"Selected\"] = \"Selected\";\n    AnnotationStyleStates[\"Locked\"] = \"Locked\";\n    AnnotationStyleStates[\"AutoGenerated\"] = \"AutoGenerated\";\n})(AnnotationStyleStates || (AnnotationStyleStates = {}));\nexport default AnnotationStyleStates;\n","var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_LABELMAP\"] = \"Converting Contour to Labelmap\";\n    ChangeTypes[\"POLYSEG_SURFACE_TO_LABELMAP\"] = \"Converting Surfaces to Labelmap\";\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_SURFACE\"] = \"Converting Contour to Surface\";\n    ChangeTypes[\"POLYSEG_LABELMAP_TO_SURFACE\"] = \"Converting Labelmap to Surface\";\n    ChangeTypes[\"SURFACE_CLIPPING\"] = \"Clipping Surfaces\";\n    ChangeTypes[\"COMPUTE_STATISTICS\"] = \"Computing Statistics\";\n    ChangeTypes[\"INTERPOLATE_LABELMAP\"] = \"Interpolating Labelmap\";\n    ChangeTypes[\"COMPUTE_LARGEST_BIDIRECTIONAL\"] = \"Computing Largest Bidirectional\";\n    ChangeTypes[\"GENERATE_CONTOUR_SETS\"] = \"Generating Contour Sets\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","// Global state to control whether to show the percentage in the overlay\nexport let showPercentage = true;\n\n/**\n * Sets whether to show the pleura percentage in the viewport overlay\n * @param value - Boolean indicating whether to show the percentage\n */\nexport function setShowPercentage(value) {\n  showPercentage = value;\n}\n","import packageJson from '../package.json';\n\nconst id = packageJson.name;\n\nexport { id };\n","import React, { useEffect, useState } from 'react';\nimport { Enums as csToolsEnums, UltrasoundPleuraBLineTool } from '@cornerstonejs/tools';\nimport { eventTarget, utilities } from '@cornerstonejs/core';\nimport { useSystem } from '@ohif/core';\n\nimport {\n  /* Layout */\n  PanelSection,\n  ScrollArea,\n  /* Controls */\n  Label,\n  Button,\n  Icons,\n  Switch,\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  Tabs,\n  TabsList,\n  TabsTrigger,\n  Separator,\n} from '@ohif/ui-next';\n\n/**\n * A side panel that drives the ultrasound annotation workflow.\n * It provides controls for managing annotations, toggling display options,\n * and downloading annotations as JSON.\n * @returns The USAnnotationPanel component\n */\nexport default function USAnnotationPanel() {\n  const { servicesManager, commandsManager } = useSystem();\n\n  /** â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   * Local state â€“ purely UI related (no business logic).   */\n\n  const { viewportGridService, cornerstoneViewportService, measurementService } =\n    servicesManager.services as AppTypes.Services;\n\n  // UI state variables\n  const [depthGuide, setDepthGuide] = useState(true);\n  const [autoAdd, setAutoAdd] = useState(true);\n  const [showPleuraPct, setShowPleuraPct] = useState(true);\n  const [showOverlay, setShowOverlay] = useState(true);\n\n  // Data state variables\n  const [annotatedFrames, setAnnotatedFrames] = useState<any[]>([]);\n  const [imageIdsToObserve, setImageIdsToObserve] = useState<string[]>([]);\n  const [labels, setLabels] = useState<string[]>([]);\n\n  /** â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   * Helper â€“ commands bridging back to OHIF services.       */\n\n  /**\n   * Switches the active annotation type (pleura or B-line)\n   * @param type - The annotation type to switch to\n   */\n  const switchAnnotation = (type: string) => {\n    commandsManager.runCommand('setToolActive', { toolName: UltrasoundPleuraBLineTool.toolName });\n    commandsManager.runCommand('switchUSAnnotation', { annotationType: type });\n  };\n\n  /**\n   * Deletes the last annotation of the specified type\n   * @param type - The annotation type to delete\n   */\n  const deleteLast = (type: string) => {\n    commandsManager.runCommand('deleteLastAnnotation', { annotationType: type });\n    updateAnnotatedFrames();\n  };\n\n  /**\n   * Sets the depth guide display state\n   * @param value - Boolean indicating whether to show the depth guide\n   */\n  const setDepthGuideCommand = (value: boolean) => {\n    commandsManager.runCommand('setDepthGuide', { value });\n    setDepthGuide(value);\n  };\n  /**\n   * Sets the auto-add annotations state\n   * When enabled, all frames are monitored for annotations\n   * When disabled, only manually added frames are monitored\n   * @param value - Boolean indicating whether to auto-add annotations\n   */\n  const setAutoAddCommand = (value: boolean) => {\n    if (value) {\n      setImageIdsToObserve([]);\n    } else {\n      const imageIds = annotatedFrames.map(item => item.imageId);\n      if (imageIds.length > 0) {\n        setImageIdsToObserve(imageIds);\n      } else {\n        setImageIdsToObserve(['Manual']);\n      }\n    }\n    setAutoAdd(value);\n  };\n  /**\n   * Sets whether to show the pleura percentage in the viewport overlay\n   * @param value - Boolean indicating whether to show the percentage\n   */\n  const setShowPleuraPercentageCommand = (value: boolean) => {\n    commandsManager.runCommand('setShowPleuraPercentage', { value });\n    setShowPleuraPct(value);\n  };\n  /**\n   * Sets whether to show the fan overlay in the viewport\n   * @param value - Boolean indicating whether to show the overlay\n   */\n  const setShowOverlayCommand = (value: boolean) => {\n    commandsManager.runCommand('setDisplayFanAnnotation', { value });\n    commandsManager.runCommand('setShowPleuraPercentage', { value });\n    setShowOverlay(value);\n  };\n  /**\n   * Downloads the annotations as a JSON file\n   * Uses the labels and imageIdsToObserve state variables\n   */\n  const downloadJSON = () => {\n    commandsManager.runCommand('downloadJSON', { labels, imageIds: imageIdsToObserve });\n  };\n\n  /**\n   * Adds the current image ID to the list of monitored image IDs\n   * Only works when auto-add is disabled\n   */\n  const addCurrentImageId = () => {\n    if (!autoAdd) {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n      const currentImageId = viewport.getCurrentImageId();\n      const imageIds = [...imageIdsToObserve];\n      if (!imageIds.includes(currentImageId)) {\n        imageIds.push(currentImageId);\n      }\n      setImageIdsToObserve(imageIds);\n    }\n  };\n\n  /**\n   * Handles clicking on a row in the annotated frames table\n   * Scrolls the viewport to the selected frame\n   * @param item - The annotated frame item that was clicked\n   */\n  const handleRowClick = item => {\n    const activeViewportId = viewportGridService.getActiveViewportId();\n    const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n    utilities.scroll(viewport, { delta: item.frame - viewport.getCurrentImageIdIndex() });\n  };\n\n  /**\n   * Render helpers so the JSX doesnâ€™t become spaghetti.     */\n  const renderWorkflowToggles = () => (\n    <PanelSection.Content>\n      <div className=\"space-y-3 p-2 text-sm text-white\">\n        <div className=\"flex items-center\">\n          <Switch\n            id=\"depth-guide-switch\"\n            className=\"mr-3\"\n            checked={depthGuide}\n            onCheckedChange={() => setDepthGuideCommand(!depthGuide)}\n          />\n          <label\n            htmlFor=\"depth-guide-switch\"\n            className=\"cursor-pointer\"\n            onClick={() => setDepthGuideCommand(!depthGuide)}\n          >\n            Depth guide toggle\n          </label>\n        </div>\n\n        {/* <div className=\"flex items-center\">\n          <Switch\n            id=\"auto-add-switch\"\n            className=\"mr-3\"\n            checked={autoAdd}\n            onCheckedChange={() => setAutoAddCommand(!autoAdd)}\n          />\n          <label\n            htmlFor=\"auto-add-switch\"\n            className=\"cursor-pointer\"\n            onClick={() => setAutoAddCommand(!autoAdd)}\n          >\n            Auto-add annotations\n          </label>\n        </div> */}\n\n        <div className=\"flex items-center\">\n          <Switch\n            id=\"pleura-percentage-switch\"\n            className=\"mr-3\"\n            checked={showPleuraPct}\n            onCheckedChange={() => setShowPleuraPercentageCommand(!showPleuraPct)}\n          />\n          <label\n            htmlFor=\"pleura-percentage-switch\"\n            className=\"cursor-pointer\"\n            onClick={() => setShowPleuraPercentageCommand(!showPleuraPct)}\n          >\n            Show pleura percentage\n          </label>\n        </div>\n      </div>\n    </PanelSection.Content>\n  );\n\n  const renderSectorAnnotations = () => (\n    <PanelSection.Content>\n      <div className=\"flex flex-col gap-4 p-2\">\n        <Label>Sector Annotations</Label>\n        <div className=\"flex items-center gap-2\">\n          <Tabs\n            defaultValue={UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE}\n            onValueChange={newValue => switchAnnotation(newValue)}\n          >\n            <TabsList>\n              <TabsTrigger value={UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.PLEURA}>\n                <Icons.Plus /> Pleura line\n              </TabsTrigger>\n              <TabsTrigger value={UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE}>\n                <Icons.Plus /> B-line\n              </TabsTrigger>\n              <Separator orientation=\"vertical\" />\n              <Separator orientation=\"vertical\" />\n            </TabsList>\n          </Tabs>\n\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" className=\"ml-auto\">\n                <Icons.More />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent>\n              <DropdownMenuItem\n                onClick={() =>\n                  deleteLast(UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE)\n                }\n              >\n                <Icons.Delete className=\"text-foreground\" />\n                <span className=\"pl-2\">B-line annotation</span>\n              </DropdownMenuItem>\n              <DropdownMenuItem\n                onClick={() =>\n                  deleteLast(UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.PLEURA)\n                }\n              >\n                <Icons.Delete className=\"text-foreground\" />\n                <span className=\"pl-2\">Pleura annotation</span>\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n\n        <div className=\"mt-2 flex items-center gap-2\">\n          <Switch\n            id=\"show-overlay-switch\"\n            checked={showOverlay}\n            onCheckedChange={() => setShowOverlayCommand(!showOverlay)}\n            className=\"data-[state=checked]:bg-blue-500\"\n          />\n          <label htmlFor=\"show-overlay-switch\" className=\"cursor-pointer text-blue-300\">\n            Show Overlay\n          </label>\n        </div>\n\n        {/* Divider */}\n        <hr className=\"border-t border-gray-800\" />\n      </div>\n    </PanelSection.Content>\n  );\n\n  const renderAnnotatedFrames = () => (\n    <ScrollArea className=\"h-full\">\n      <PanelSection.Content>\n        <div className=\"mb-4 flex items-center justify-between\">\n          {/* <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"text-blue-300\"\n            disabled={autoAdd}\n            onClick={addCurrentImageId}\n          >\n            <Icons.Plus className=\"mr-2\" /> Add current frame\n          </Button> */}\n          <Button variant=\"ghost\" onClick={() => downloadJSON()}>\n            <Icons.Download className=\"h-5 w-5\" />\n            <span>JSON</span>\n          </Button>\n          <Button variant=\"ghost\" onClick={() => setShowOverlayCommand(!showOverlay)}>\n            {showOverlay ? <Icons.Hide className=\"h-5 w-5\" /> : <Icons.Show className=\"h-5 w-5\" />}\n          </Button>\n        </div>\n        <div className=\"w-full overflow-hidden\">\n          <table className=\"w-full border-collapse text-sm\">\n            <thead>\n              <tr className=\"border-b border-blue-900 text-blue-300\">\n                <th></th>\n                <th className=\"py-2 px-3 text-left\">Frame</th>\n                <th className=\"py-2 px-3 text-center\">Pleura lines</th>\n                <th className=\"py-2 px-3 text-center\">B-lines</th>\n                <th className=\"w-10\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              {annotatedFrames.map(item => (\n                <tr\n                  key={item.frame}\n                  className={`border-b border-blue-900 ${\n                    item.frame === 5 ? 'bg-cyan-800 bg-opacity-30' : ''\n                  }`}\n                  onClick={() => handleRowClick(item)}\n                  style={{ cursor: 'pointer' }}\n                >\n                  <td className=\"py-3 px-3\">{item.index}</td>\n                  <td className=\"py-3 px-3\">{item.frame + 1}</td>\n                  <td className=\"py-3 px-3 text-center\">{item.pleura}</td>\n                  <td className=\"py-3 px-3 text-center\">{item.bLine}</td>\n                  <td className=\"py-3 px-3 text-right\">\n                    {item.frame === 5 && (\n                      <div className=\"flex items-center justify-end\">\n                        <Button variant=\"ghost\" className=\"p-0 text-blue-300\">\n                          <Icons.EyeVisible />\n                        </Button>\n                        <Button variant=\"ghost\" className=\"ml-2 p-0 text-blue-300\">\n                          <Icons.More />\n                        </Button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </PanelSection.Content>\n    </ScrollArea>\n  );\n\n  const updateAnnotatedFrames = () => {\n    const activeViewportId = viewportGridService.getActiveViewportId();\n    const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n    // copying to avoid mutating the original array\n    const imageIdsMonitored = [...imageIdsToObserve];\n    const imageIdFilter = (imageId: string) => {\n      if (imageIdsMonitored.length === 0) {\n        return true;\n      }\n      return imageIdsMonitored.includes(imageId);\n    };\n    const mapping = UltrasoundPleuraBLineTool.countAnnotations(viewport.element, imageIdFilter);\n    if (!mapping) {\n      setAnnotatedFrames([]);\n      return;\n    }\n    const keys = Array.from(mapping.keys());\n    const updatedFrames = keys.map((key, index) => {\n      const { pleura, bLine, frame } = mapping.get(key) || { pleura: 0, bLine: 0, frame: 0 };\n      return { imageId: key, index: index + 1, frame, pleura, bLine };\n    });\n    setAnnotatedFrames(updatedFrames);\n  };\n  /**\n   * Callback function that is called when an annotation is modified\n   * Updates the annotatedFrames state with the latest annotation data\n   */\n  const annotationModified = React.useCallback(\n    event => {\n      if (event.detail.annotation.metadata.toolName === UltrasoundPleuraBLineTool.toolName) {\n        updateAnnotatedFrames();\n      }\n    },\n    [viewportGridService, cornerstoneViewportService, imageIdsToObserve]\n  );\n\n  useEffect(() => {\n    eventTarget.addEventListener(csToolsEnums.Events.ANNOTATION_MODIFIED, annotationModified);\n    const { unsubscribe } = measurementService.subscribe(\n      measurementService.EVENTS.MEASUREMENT_REMOVED,\n      () => {\n        updateAnnotatedFrames();\n      }\n    );\n\n    return () => {\n      eventTarget.removeEventListener(csToolsEnums.Events.ANNOTATION_MODIFIED, annotationModified);\n      unsubscribe();\n    };\n  }, [annotationModified, measurementService]);\n\n  /**\n   * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n   *  ðŸ–¼  Final Render                                      */\n  return (\n    <div\n      className=\"h-full bg-black text-white\"\n      style={{ minWidth: 240, maxWidth: 480, width: '100%' }}\n    >\n      {/* Workflow */}\n      <PanelSection>\n        <PanelSection.Header>Workflow</PanelSection.Header>\n        {renderWorkflowToggles()}\n      </PanelSection>\n\n      {/* Progress\n      <PanelSection>\n        <SectionHeader title=\"Workflow Progress\" actionLabel=\"Source Folder\" />\n        {renderWorkflowProgress()}\n      </PanelSection> */}\n\n      {/* Annotations */}\n      <PanelSection>\n        <PanelSection.Header> Annotations </PanelSection.Header>\n        {renderSectorAnnotations()}\n      </PanelSection>\n\n      {/* Annotated frames */}\n      <PanelSection className=\"flex-1\">\n        <PanelSection.Header> Annotated Frames </PanelSection.Header>\n        {renderAnnotatedFrames()}\n      </PanelSection>\n    </div>\n  );\n}\n","import React from 'react';\n\nimport USAnnotationPanel from './panels/USAnnotationPanel';\n\n/**\n * Creates and returns the panel module for ultrasound annotation\n * @param params - Object containing commandsManager, servicesManager, and extensionManager\n * @returns Array of panel configurations\n */\nconst getPanelModule = ({ commandsManager, servicesManager, extensionManager }: withAppTypes) => {\n  /**\n   * Wrapper component for the USAnnotationPanel that injects the required props\n   * @param props - Component props including configuration\n   * @returns The wrapped USAnnotationPanel component\n   */\n  const wrappedUSAnnotationPanel = ({ configuration }) => {\n    return <USAnnotationPanel />;\n  };\n\n  return [\n    {\n      name: 'USAnnotationPanel',\n      iconName: 'tab-linear',\n      iconLabel: 'US Annotation',\n      label: 'USAnnotation',\n      component: wrappedUSAnnotationPanel,\n    },\n  ];\n};\n\nexport default getPanelModule;\n","import { UltrasoundPleuraBLineTool, Enums as csToolsEnums } from '@cornerstonejs/tools';\nimport { Types as OhifTypes } from '@ohif/core';\nimport { eventTarget, triggerEvent, utilities } from '@cornerstonejs/core';\nimport getInstanceByImageId from './getInstanceByImageId';\nimport { setShowPercentage } from './PleuraBlinePercentage';\n\nconst { transformWorldToIndex } = utilities;\n\n/**\n * Creates and returns the commands module for ultrasound annotation\n * @param params - Extension parameters including servicesManager and commandsManager\n * @returns The commands module with actions and definitions\n */\nfunction commandsModule({\n  servicesManager,\n  commandsManager,\n}: OhifTypes.Extensions.ExtensionParams): OhifTypes.Extensions.CommandsModule {\n  const { viewportGridService, toolGroupService, cornerstoneViewportService } =\n    servicesManager.services as AppTypes.Services;\n\n  const actions = {\n    /**\n     * Switches the active ultrasound annotation type\n     * @param options - Object containing the annotationType to switch to\n     */\n    switchUSPleuraBLineAnnotation: ({ annotationType }) => {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const toolGroup = toolGroupService.getToolGroupForViewport(activeViewportId);\n      if (!toolGroup) {\n        return;\n      }\n      const usAnnotation = toolGroup.getToolInstance(UltrasoundPleuraBLineTool.toolName);\n      if (usAnnotation) {\n        usAnnotation.setActiveAnnotationType(annotationType);\n      }\n    },\n    /**\n     * Convenience method to switch to pleura line annotation type\n     */\n    switchUSPleuraBLineAnnotationToPleuraLine: () => {\n      actions.switchUSPleuraBLineAnnotation({\n        annotationType: UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.PLEURA,\n      });\n    },\n    /**\n     * Convenience method to switch to B-line annotation type\n     */\n    switchUSPleuraBLineAnnotationToBLine: () => {\n      actions.switchUSPleuraBLineAnnotation({\n        annotationType: UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE,\n      });\n    },\n    /**\n     * Deletes the last annotation of the specified type\n     * @param options - Object containing the annotationType to delete\n     */\n    deleteLastUSPleuraBLineAnnotation: ({ annotationType }) => {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const toolGroup = toolGroupService.getToolGroupForViewport(activeViewportId);\n      if (!toolGroup) {\n        return;\n      }\n      const usAnnotation = toolGroup.getToolInstance(UltrasoundPleuraBLineTool.toolName);\n      if (usAnnotation) {\n        const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n        usAnnotation.deleteLastAnnotationType(viewport.element, annotationType);\n        viewport.render();\n      }\n    },\n\n    /**\n     * Convenience method to delete the last pleura line annotation\n     */\n    deleteLastPleuraAnnotation: () => {\n      actions.deleteLastUSPleuraBLineAnnotation({\n        annotationType: UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.PLEURA,\n      });\n    },\n    /**\n     * Convenience method to delete the last B-line annotation\n     */\n    deleteLastBLineAnnotation: () => {\n      actions.deleteLastUSPleuraBLineAnnotation({\n        annotationType: UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE,\n      });\n    },\n    /**\n     * Toggles a boolean attribute of the ultrasound annotation tool\n     * @param options - Object containing the attribute name to toggle\n     */\n    toggleUSToolAttribute: ({ attribute }) => {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const toolGroup = toolGroupService.getToolGroupForViewport(activeViewportId);\n      if (!toolGroup) {\n        return;\n      }\n      const configuration = toolGroup.getToolConfiguration(UltrasoundPleuraBLineTool.toolName);\n      if (!configuration) {\n        return;\n      }\n      toolGroup.setToolConfiguration(UltrasoundPleuraBLineTool.toolName, {\n        [attribute]: !configuration[attribute],\n      });\n      const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n      viewport.render();\n    },\n    /**\n     * Sets a specific attribute of the ultrasound annotation tool to a given value\n     * @param options - Object containing the attribute name and value to set\n     */\n    setUSToolAttribute: ({ attribute, value }) => {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const toolGroup = toolGroupService.getToolGroupForViewport(activeViewportId);\n      if (!toolGroup) {\n        return;\n      }\n      const configuration = toolGroup.getToolConfiguration(UltrasoundPleuraBLineTool.toolName);\n      if (!configuration) {\n        return;\n      }\n      toolGroup.setToolConfiguration(UltrasoundPleuraBLineTool.toolName, {\n        [attribute]: value,\n      });\n      const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n      viewport.render();\n    },\n    /**\n     * Toggles the display of fan annotations\n     */\n    toggleDisplayFanAnnotation: () => {\n      actions.toggleUSToolAttribute({\n        attribute: 'showFanAnnotations',\n      });\n    },\n    /**\n     * Toggles the display of the depth guide\n     */\n    toggleDepthGuide: () => {\n      actions.toggleUSToolAttribute({\n        attribute: 'drawDepthGuide',\n      });\n    },\n    /**\n     * Sets the depth guide display state\n     * @param options - Object containing the boolean value to set\n     */\n    setDepthGuide: ({ value }) => {\n      actions.setUSToolAttribute({\n        attribute: 'drawDepthGuide',\n        value,\n      });\n    },\n    /**\n     * Sets the fan annotation display state\n     * @param options - Object containing the boolean value to set\n     */\n    setDisplayFanAnnotation: ({ value }) => {\n      actions.setUSToolAttribute({\n        attribute: 'showFanAnnotations',\n        value,\n      });\n    },\n    /**\n     * Sets whether to show the pleura percentage in the viewport overlay\n     * @param options - Object containing the boolean value to set\n     */\n    setShowPleuraPercentage: ({ value }) => {\n      setShowPercentage(value);\n      // Trigger ANNOTATION_MODIFIED event to update the overlay\n      triggerEvent(eventTarget, csToolsEnums.Events.ANNOTATION_MODIFIED, {\n        annotation: {\n          metadata: {\n            toolName: UltrasoundPleuraBLineTool.toolName,\n          },\n        },\n      });\n    },\n    /**\n     * Generates a JSON representation of the ultrasound annotations\n     * @param labels - Array of annotation labels\n     * @param imageIds - Array of image IDs to include in the JSON\n     * @returns A JSON object containing the annotations data or undefined if generation fails\n     */\n    generateUSPleuraBLineAnnotationsJSON: (labels: string[] = [], imageIds: string[] = []) => {\n      const activeViewportId = viewportGridService.getActiveViewportId();\n      const viewport = cornerstoneViewportService.getCornerstoneViewport(activeViewportId);\n      if (!viewport) {\n        return;\n      }\n      const { imageData } = viewport.getImageData() || {};\n      if (!imageData) {\n        return;\n      }\n\n      const toolGroup = toolGroupService.getToolGroupForViewport(activeViewportId);\n      if (!toolGroup) {\n        return;\n      }\n      const usAnnotation = toolGroup.getToolInstance(UltrasoundPleuraBLineTool.toolName);\n      if (usAnnotation) {\n        const configuration = toolGroup.getToolConfiguration(UltrasoundPleuraBLineTool.toolName);\n        const imageId = viewport.getCurrentImageId();\n        const filterImageIds = (imageId: string) => {\n          if (imageIds.length === 0) {\n            return true;\n          } else {\n            return imageIds.includes(imageId);\n          }\n        };\n        const annotations = UltrasoundPleuraBLineTool.filterAnnotations(\n          viewport.element,\n          filterImageIds\n        );\n        const frame_annotations = {};\n        const viewportImageIds = viewport.getImageIds();\n        annotations.forEach(annotation => {\n          const imageId = annotation.metadata.referencedImageId;\n          const { annotationType } = annotation.data;\n          const [point1, point2] = annotation.data.handles.points;\n          const p1 = transformWorldToIndex(imageData, point1);\n          const p2 = transformWorldToIndex(imageData, point2);\n          const imageIdIndex = viewportImageIds.indexOf(imageId);\n          if (frame_annotations[imageIdIndex] === undefined) {\n            frame_annotations[imageIdIndex] = {\n              pleura_lines: [],\n              b_lines: [],\n            };\n          }\n          if (annotationType === UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.PLEURA) {\n            frame_annotations[imageIdIndex].pleura_lines.push([\n              [p1[0], p1[1], 0],\n              [p2[0], p2[1], 0],\n            ]);\n          } else if (\n            annotationType === UltrasoundPleuraBLineTool.USPleuraBLineAnnotationType.BLINE\n          ) {\n            frame_annotations[imageIdIndex].b_lines.push([\n              [p1[0], p1[1], 0],\n              [p2[0], p2[1], 0],\n            ]);\n          }\n        });\n\n        const instance = getInstanceByImageId(servicesManager.services, imageId);\n        const json = {\n          SOPInstanceUID: instance.SOPInstanceUID,\n          GrayscaleConversion: false,\n          mask_type: 'fan',\n          angle1: configuration.startAngle,\n          angle2: configuration.endAngle,\n          center_rows_px: configuration.center[0],\n          center_cols_px: configuration.center[1],\n          radius1: configuration.innerRadius,\n          radius2: configuration.outerRadius,\n          image_size_rows: instance.rows,\n          image_size_cols: instance.columns,\n          AnnotationLabels: labels,\n          frame_annotations,\n        };\n        return json;\n      }\n    },\n    /**\n     * Downloads the ultrasound annotations as a JSON file\n     * @param options - Object containing labels and imageIds arrays\n     */\n    downloadUSPleuraBLineAnnotationsJSON({ labels = [], imageIds = [] }) {\n      const json = actions.generateUSPleuraBLineAnnotationsJSON(labels, imageIds);\n      if (!json) {\n        return;\n      }\n\n      // Convert JSON object to a string\n      const jsonString = JSON.stringify(json, null, 2);\n\n      // Create a blob with the JSON data\n      const blob = new Blob([jsonString], { type: 'application/json' });\n\n      // Create a URL for the blob\n      const url = URL.createObjectURL(blob);\n\n      // Create an anchor element\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `ultrasound_annotations_${new Date().toISOString().slice(0, 10)}.json`;\n\n      // Append to the document, click to download, and remove\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n\n      // Clean up by revoking the URL\n      URL.revokeObjectURL(url);\n    },\n  };\n\n  const definitions = {\n    switchUSAnnotation: {\n      commandFn: actions.switchUSPleuraBLineAnnotation,\n    },\n    deleteLastAnnotation: {\n      commandFn: actions.deleteLastUSPleuraBLineAnnotation,\n    },\n    toggleDepthGuide: {\n      commandFn: actions.toggleDepthGuide,\n    },\n    setDepthGuide: {\n      commandFn: actions.setDepthGuide,\n    },\n    setShowPleuraPercentage: {\n      commandFn: actions.setShowPleuraPercentage,\n    },\n    toggleUSToolAttribute: {\n      commandFn: actions.toggleUSToolAttribute,\n    },\n    setUSToolAttribute: {\n      commandFn: actions.setUSToolAttribute,\n    },\n    toggleDisplayFanAnnotation: {\n      commandFn: actions.toggleDisplayFanAnnotation,\n    },\n    setDisplayFanAnnotation: {\n      commandFn: actions.setDisplayFanAnnotation,\n    },\n    generateJSON: {\n      commandFn: actions.generateUSPleuraBLineAnnotationsJSON,\n    },\n    downloadJSON: {\n      commandFn: actions.downloadUSPleuraBLineAnnotationsJSON,\n    },\n    switchUSAnnotationToPleuraLine: {\n      commandFn: actions.switchUSPleuraBLineAnnotationToPleuraLine,\n    },\n    switchUSAnnotationToBLine: {\n      commandFn: actions.switchUSPleuraBLineAnnotationToBLine,\n    },\n    deleteLastPleuraAnnotation: {\n      commandFn: actions.deleteLastPleuraAnnotation,\n    },\n    deleteLastBLineAnnotation: {\n      commandFn: actions.deleteLastBLineAnnotation,\n    },\n  };\n\n  return {\n    actions,\n    definitions,\n    defaultContext: 'CORNERSTONE',\n  };\n}\n\nexport default commandsModule;\n","import { id } from './id';\nimport getPanelModule from './getPanelModule';\nimport getCommandsModule from './getCommandsModule';\nimport { showPercentage, setShowPercentage } from './PleuraBlinePercentage';\n/**\n * You can remove any of the following modules if you don't need them.\n */\nexport default {\n  /**\n   * Only required property. Should be a unique value across all extensions.\n   * You ID can be anything you want, but it should be unique.\n   */\n  id,\n  /**\n   * PanelModule should provide a list of panels that will be available in OHIF\n   * for Modes to consume and render. Each panel is defined by a {name,\n   * iconName, iconLabel, label, component} object. Example of a panel module\n   * is the StudyBrowserPanel that is provided by the default extension in OHIF.\n   */\n  getPanelModule,\n  /**\n   * CommandsModule should provide a list of commands that will be available in OHIF\n   * for Modes to consume and use in the viewports. Each command is defined by\n   * an object of { actions, definitions, defaultContext } where actions is an\n   * object of functions, definitions is an object of available commands, their\n   * options, and defaultContext is the default context for the command to run against.\n   */\n  getCommandsModule,\n};\n\nexport { showPercentage, setShowPercentage };\n","/**\n * Retrieves the DICOM instance associated with a specific imageId\n * @param services - The OHIF services object\n * @param imageId - The image ID to find the instance for\n * @returns The DICOM instance object or undefined if not found\n */\nexport default function getInstanceByImageId(services: AppTypes.Services, imageId: string) {\n  const activeDisplaySets = services.displaySetService.getActiveDisplaySets();\n  const displaySet = activeDisplaySets.find(displaySet => displaySet?.imageIds?.includes(imageId));\n  return displaySet?.instance;\n}\n"],"names":["ChangeTypes","Events","SegmentationRepresentations","StrategyCallbacks","MouseBindings","KeyboardBindings","ToolModes","Swipe","AnnotationStyleStates","showPercentage","setShowPercentage","value","id","packageJson","USAnnotationPanel","servicesManager","commandsManager","useSystem","viewportGridService","cornerstoneViewportService","measurementService","services","depthGuide","setDepthGuide","useState","autoAdd","setAutoAdd","showPleuraPct","setShowPleuraPct","showOverlay","setShowOverlay","annotatedFrames","setAnnotatedFrames","imageIdsToObserve","setImageIdsToObserve","labels","setLabels","deleteLast","type","runCommand","annotationType","updateAnnotatedFrames","setDepthGuideCommand","setShowPleuraPercentageCommand","setShowOverlayCommand","activeViewportId","getActiveViewportId","viewport","getCornerstoneViewport","imageIdsMonitored","mapping","UltrasoundPleuraBLineTool","countAnnotations","element","imageId","length","includes","updatedFrames","Array","from","keys","map","key","index","pleura","bLine","frame","get","annotationModified","React","event","detail","annotation","metadata","toolName","useEffect","eventTarget","addEventListener","csToolsEnums","ANNOTATION_MODIFIED","unsubscribe","subscribe","EVENTS","MEASUREMENT_REMOVED","removeEventListener","className","style","minWidth","maxWidth","width","PanelSection","Header","Content","Switch","checked","onCheckedChange","htmlFor","onClick","Label","Tabs","defaultValue","USPleuraBLineAnnotationType","BLINE","onValueChange","newValue","switchAnnotation","TabsList","TabsTrigger","PLEURA","Icons","Plus","Separator","orientation","DropdownMenu","DropdownMenuTrigger","asChild","Button","variant","More","DropdownMenuContent","DropdownMenuItem","Delete","ScrollArea","imageIds","Download","Hide","Show","item","utilities","delta","getCurrentImageIdIndex","handleRowClick","cursor","EyeVisible","getPanelModule","extensionManager","name","iconName","iconLabel","label","component","wrappedUSAnnotationPanel","configuration","transformWorldToIndex","getCommandsModule","toolGroupService","actions","switchUSPleuraBLineAnnotation","toolGroup","getToolGroupForViewport","usAnnotation","getToolInstance","setActiveAnnotationType","switchUSPleuraBLineAnnotationToPleuraLine","switchUSPleuraBLineAnnotationToBLine","deleteLastUSPleuraBLineAnnotation","deleteLastAnnotationType","render","deleteLastPleuraAnnotation","deleteLastBLineAnnotation","toggleUSToolAttribute","attribute","getToolConfiguration","setToolConfiguration","setUSToolAttribute","toggleDisplayFanAnnotation","toggleDepthGuide","setDisplayFanAnnotation","setShowPleuraPercentage","triggerEvent","generateUSPleuraBLineAnnotationsJSON","imageData","getImageData","getCurrentImageId","filterImageIds","annotations","filterAnnotations","frame_annotations","viewportImageIds","getImageIds","forEach","referencedImageId","data","point1","point2","handles","points","p1","p2","imageIdIndex","indexOf","undefined","pleura_lines","b_lines","push","instance","displaySet","displaySetService","getActiveDisplaySets","find","getInstanceByImageId","SOPInstanceUID","GrayscaleConversion","mask_type","angle1","startAngle","angle2","endAngle","center_rows_px","center","center_cols_px","radius1","innerRadius","radius2","outerRadius","image_size_rows","rows","image_size_cols","columns","AnnotationLabels","downloadUSPleuraBLineAnnotationsJSON","json","jsonString","JSON","stringify","blob","Blob","url","URL","createObjectURL","a","document","createElement","href","download","Date","toISOString","slice","body","appendChild","click","removeChild","revokeObjectURL","definitions","switchUSAnnotation","commandFn","deleteLastAnnotation","generateJSON","downloadJSON","switchUSAnnotationToPleuraLine","switchUSAnnotationToBLine","defaultContext"],"sourceRoot":""}